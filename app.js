const { Client, LocalAuth } = require('whatsapp-web.js');
const qrcode_terminal = require('qrcode-terminal');

// Initialize WhatsApp Client
// const client = new Client({
//     authStrategy: new LocalAuth() // This will handle storing and reusing your session
//     puppeteer: {
//         executablePath: chromium.path // –£–∫–∞–∑—ã–≤–∞–µ–º –ø—É—Ç—å –∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º—É Chromium
//     }
// });

const client = new Client({
    puppeteer: {
        headless: true,
        args: ['--no-sandbox'],
        authStrategy: new LocalAuth()
    }
});

// Client is ready to start handling messages
client.on('ready', () => {
    console.log('WhatsApp bot is ready!');
});

// Store user states
let userStates = { state: ' ', question: ' ' };
let questionnaireAnswer = {};
let expertHelpAnswer = {};

const questions = [
    "–ö–∞–∫–æ–≤–∞ –æ—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å –≤–∞—à–µ–π –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å –Ω–∞ –ë–∞–ª–∏?",
    "–ö–∞–∫–∏–º —Ç–∏–ø–æ–º –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –≤—ã –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç–µ—Å—å?",
    "–ö–∞–∫–æ–≤ –≤–∞—à –±—é–¥–∂–µ—Ç –Ω–∞ –ø–æ–∫—É–ø–∫—É –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏?",
    "–í –∫–∞–∫–æ–º —Ä–∞–π–æ–Ω–µ –ë–∞–ª–∏ –≤—ã –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å?",
    "–ö–∞–∫—É—é –æ–∂–∏–¥–∞–µ–º—É—é –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∏–ª–∏ –≤—ã–≥–æ–¥—É –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –æ—Ç –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –≤ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å –Ω–∞ –ë–∞–ª–∏?",
    "–ö–æ–≥–¥–∞ –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ —Å–æ–≤–µ—Ä—à–∏—Ç—å –ø–æ–∫—É–ø–∫—É –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏?",
    "–ï—Å—Ç—å –ª–∏ —É –≤–∞—Å –∫–∞–∫–∏–µ-–ª–∏–±–æ –æ—Å–æ–±—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏–ª–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –∫ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—É—é –≤—ã –∏—â–µ—Ç–µ?",
    "–ú–µ—Ç–æ–¥ –æ–ø–ª–∞—Ç—ã?",
    "–ö–∞–∫ –≤—ã —Ö–æ—Ç–µ–ª–∏ –±—ã –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –æ–ø–ª–∞—Ç—É?",
    "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –≤–∞—à–µ –ø–æ–ª–Ω–æ–µ –∏–º—è:",
    "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞–º–∏:"
];


const options = [
    ["–î–ª—è –ª–∏—á–Ω–æ–≥–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è", "–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Ö–æ–¥–∞ –æ—Ç –∞—Ä–µ–Ω–¥—ã", "–î–ª—è –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–∏ —Å –ø—Ä–∏–±—ã–ª—å—é", "–î—Ä—É–≥–æ–µ (–ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Ç–æ—á–Ω–∏—Ç–µ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –Ω–∏–∂–µ)"],
    ["–ê–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã", "–í–∏–ª–ª–∞", "–ó–µ–º–µ–ª—å–Ω—ã–π —É—á–∞—Å—Ç–æ–∫", "–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å", "–î—Ä—É–≥–æ–µ (–ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Ç–æ—á–Ω–∏—Ç–µ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –Ω–∏–∂–µ)"],
    ["–î–æ $100,000", "$100,000 - $300,000", "$300,000 - $500,000", "$500,000 - $1,000,000", "–ë–æ–ª–µ–µ $1,000,000"],
    ["–ö—É—Ç–∞", "–°–µ–º–∏–Ω—å—è–∫", "–ß–∞–Ω–≥—É", "–£–±—É–¥", "–î–∂–∏–º–±–∞—Ä–∞–Ω", "–î—Ä—É–≥–∏–µ —Ä–∞–π–æ–Ω—ã (–ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Ç–æ—á–Ω–∏—Ç–µ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –Ω–∏–∂–µ)"],
    ["–î–æ 5% –≥–æ–¥–æ–≤—ã—Ö", "5-10% –≥–æ–¥–æ–≤—ã—Ö", "10-15% –≥–æ–¥–æ–≤—ã—Ö", "–ë–æ–ª–µ–µ 15% –≥–æ–¥–æ–≤—ã—Ö", "–¢—Ä—É–¥–Ω–æ —Å–∫–∞–∑–∞—Ç—å, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é –Ω–∞ –≤–∞—à—É –ø–æ–º–æ—â—å –≤ –æ—Ü–µ–Ω–∫–µ"],
    ["–í —Ç–µ—á–µ–Ω–∏–µ –±–ª–∏–∂–∞–π—à–∏—Ö 3 –º–µ—Å—è—Ü–µ–≤", "–í —Ç–µ—á–µ–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤", "–í —Ç–µ—á–µ–Ω–∏–µ –≥–æ–¥–∞", "–ë–æ–ª–µ–µ –≥–æ–¥–∞"],
    ["–î–∞ (–ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Ç–æ—á–Ω–∏—Ç–µ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –Ω–∏–∂–µ)", "–ù–µ—Ç"],
    ["–ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥", "–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞", "–û–ø–ª–∞—Ç–∞ –Ω–∞–ª–∏—á–Ω—ã–º–∏"],
    ["–†–∞—Å—Å—Ä–æ—á–∫–∞", "–ü–æ–ª–Ω–∞—è —Å—É–º–º–∞"]
];

// Handling incoming messages
client.on('message', async (msg) => {
    const chatId = msg.from;
    console.log(`Received message from ${chatId}: ${msg.body}`);

    // Example: Reply to a specific message
    if (msg.body.toLowerCase() === 'start' || msg.body.toLowerCase() === '—Å—Ç–∞—Ä—Ç') {
        try {
            userStates[chatId] = { state: 'main_menu', question: '' };
            const introText =
                "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ–º –≤–∞—Å –≤ –ê–ù ‚ÄúCondor Real Estates‚Äù!\n\n" +
                "–ú—ã —Ä–∞–¥—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤–∞—Å –≤ –Ω–∞—à–µ–º WhatsApp-–±–æ—Ç–µ! –ù–∞—à–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –Ω–∞ –ë–∞–ª–∏, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –≤–∞–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –≤—ã–≥–æ–¥–Ω—ã—Ö –≤–ª–æ–∂–µ–Ω–∏–π –≤ –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –∂–∏–≤–æ–ø–∏—Å–Ω—ã—Ö —É–≥–æ–ª–∫–æ–≤ –º–∏—Ä–∞.\n\n" +
                "–ú—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º —à–∏—Ä–æ–∫–∏–π —Å–ø–µ–∫—Ç—Ä —É—Å–ª—É–≥, –≤–∫–ª—é—á–∞—è –ø–æ–∫—É–ø–∫—É, –ø—Ä–æ–¥–∞–∂—É –∏ –∞—Ä–µ–Ω–¥—É –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏, –∞ —Ç–∞–∫–∂–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è–º –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –æ–±—ä–µ–∫—Ç–∞–º–∏. –ù–∞—à–∏ —ç–∫—Å–ø–µ—Ä—Ç—ã –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å –≤–∞–º –Ω–∞–π—Ç–∏ –Ω–∞–∏–ª—É—á—à–∏–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤–∞—à–∏—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ü–µ–ª–µ–π.\n\n" +
                "–° —á–µ–≥–æ –≤–∞–º –Ω–∞—á–∞—Ç—å ‚ÅâÔ∏è\n" +
                "‚û°Ô∏è–ü—Ä–æ–π—Ç–∏ –æ–ø—Ä–æ—Å, —á—Ç–æ–±—ã –º—ã —Å–º–æ–≥–ª–∏ –ø–æ–¥–æ–±—Ä–∞—Ç—å –≤–∞–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –ø–æ–¥ –≤–∞—à –∑–∞–ø—Ä–æ—Å –∏ –≤—ã –Ω–∞–≥–ª—è–¥–Ω–æ —É–≤–∏–¥–µ–ª–∏, —á—Ç–æ –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –Ω–∞ –≤–∞—à –±—é–¥–∂–µ—Ç.\n‚û°Ô∏è–°–ª–µ–¥–∏—Ç–µ –∑–∞ –Ω–∞—à–∏–º–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏, –ø–æ–ª—É—á–∞–π—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–∞—Ö –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö, –∞ —Ç–∞–∫–∂–µ –∑–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã ‚Äî –º—ã –≤—Å–µ–≥–¥–∞ –Ω–∞ —Å–≤—è–∑–∏ –∏ –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å!\n\n" +
                "–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –≤—ã–±—Ä–∞–ª–∏ –Ω–∞—Å. –î–∞–≤–∞–π—Ç–µ –≤–º–µ—Å—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º –í–∞—à–µ —É—Å–ø–µ—à–Ω–æ–µ –±—É–¥—É—â–µ–µ –Ω–∞ –ë–∞–ª–∏!\n\n" +
                "‚¨áÔ∏è–°–¥–µ–ª–∞–π—Ç–µ —Å–≤–æ–π –≤—ã–±–æ—Ä‚¨áÔ∏è";

            const menuText =
                "1. –ê–Ω–∫–µ—Ç–∞\n" +
                "2. –≠–∫—Å–ø–µ—Ä—Ç–Ω–∞—è –ø–æ–º–æ—â—å —Å –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é\n" +
                "3. [–û –Ω–∞—Å](https://t.me)\n" +
                "4. –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è\n\n" +
                "–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–æ–º–µ—Ä–æ–º –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å.";

            await await client.sendMessage(chatId, introText);
            await await client.sendMessage(chatId, menuText);
        } catch (error) {
            await console.log(userStates[chatId]);
            await console.log("ERROR SENDING - " + error);
        }
    } else if (userStates[chatId].state === 'main_menu' && msg.body === "1") {
        userStates[chatId].state = "questionaire";
        userStates[chatId].question = "1";
        const messageIntro = `
üåü *–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à –æ–ø—Ä–æ—Å–Ω–∏–∫!* üåü

–í—ã —Å–µ–π—á–∞—Å –ø—Ä–æ—Ö–æ–¥–∏—Ç–µ –æ–ø—Ä–æ—Å, –≤ –∫–æ—Ç–æ—Ä–æ–º –≤–∞–º –±—É–¥—É—Ç –∑–∞–¥–∞–Ω—ã –≤–æ–ø—Ä–æ—Å—ã —Å –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –æ—Ç–≤–µ—Ç–æ–≤. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–≤–µ—á–∞–π—Ç–µ, –æ—Ç–ø—Ä–∞–≤–ª—è—è —Ç–æ–ª—å–∫–æ –Ω–æ–º–µ—Ä –≤–∞—à–µ–≥–æ –≤—ã–±–æ—Ä–∞. 

–ï—Å–ª–∏ –≤ –æ–ø—Ä–æ—Å–µ –ø–æ—è–≤–∏—Ç—Å—è –≤–∞—Ä–∏–∞–Ω—Ç —Å –ø—Ä–æ—Å—å–±–æ–π "*—É—Ç–æ—á–Ω–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ —á–∞—Ç–µ*", –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ –≤ —á–∞—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –æ—Ç–≤–µ—Ç–∞.

–í–∞—à–µ —É—á–∞—Å—Ç–∏–µ –ø–æ–º–æ–∂–µ—Ç –Ω–∞–º –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å –≤–∞—à–∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤–∞–º –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à–µ –≤—Ä–µ–º—è –∏ –≤–Ω–∏–º–∞–Ω–∏–µ!
    `;

        await client.sendMessage(chatId, messageIntro, { parse_mode: 'Markdown' });
        await sendQuestion(chatId, questions[0], options[0]);
    } else if (userStates[chatId].state === 'main_menu' && msg.body === "2") {
        await client.sendMessage(msg.from,
            '*–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Condor Real Estates.*\n\n' +
            '–ú—ã —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º—Å—è –Ω–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è—Ö –≤ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å –Ω–∞ –ë–∞–ª–∏ –∏ –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å –≤–∞–º —Å–¥–µ–ª–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä. ' +
            '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Å–≤–æ–∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —á—Ç–æ–±—ã –Ω–∞—à–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã –º–æ–≥–ª–∏ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –≤–∞–º–∏ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤—Å—é –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.\n\n' +
            '–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è —Å–≤—è–∑–∏ —Å –≤–∞–º–∏ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π –ø–æ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è–º –≤ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å.',
            { parse_mode: 'Markdown' }
        );

        await client.sendMessage(chatId,
            '*–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –≤–∞—à –∞–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã:*',
            { parse_mode: 'Markdown' }
        );
        userStates[chatId].state = 'expert_help';
        userStates[chatId].question = 'email';
    } else if (userStates[chatId].state === 'main_menu' && msg.body === "3") {
        const aboutUsText = `*–û –Ω–∞—Å*\n\n` +
            `–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Condor Real Estates! –ú—ã —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º—Å—è –Ω–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è—Ö –≤ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å –Ω–∞ –ë–∞–ª–∏, –ø–æ–º–æ–≥–∞—è –Ω–∞—à–∏–º –∫–ª–∏–µ–Ω—Ç–∞–º –¥–µ–ª–∞—Ç—å –≤—ã–≥–æ–¥–Ω—ã–µ –∏ –ø—Ä–æ–¥—É–º–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è.\n\n` +
            `–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ –æ –Ω–∞—Å –∏ –Ω–∞—à–∏—Ö —É—Å–ª—É–≥–∞—Ö –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞ –Ω–∞—à–µ–º —Å–∞–π—Ç–µ: https://www.example.com.\n\n` +
            `–ú—ã —Å—Ç—Ä–µ–º–∏–º—Å—è –æ–±–µ—Å–ø–µ—á–∏—Ç—å –≤–∞—Å –≤—Å–µ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –¥–ª—è —É—Å–ø–µ—à–Ω—ã—Ö –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –∏ –≥–æ—Ç–æ–≤—ã –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –ª—é–±—ã–µ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã.\n\n` +
            `–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è—Ö, –∏–ª–∏ –ø–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥—Ä—É–≥–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –±–æ—Ç–∞, —Ç–æ –≤–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –∏—Å—Ç–µ—Ä–µ—Å—É–µ–º–æ–≥–æ –ø—É–Ω–∫—Ç–∞ –º–µ–Ω—é –≤ —á–∞—Ç:\n` +
            `1. –ê–Ω–∫–µ—Ç–∞\n` +
            `2. –≠–∫—Å–ø–µ—Ä—Ç–Ω–∞—è –ø–æ–º–æ—â—å —Å –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é\n` +
            `4. –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è`;
        await client.sendMessage(msg.from, aboutUsText, { parse_mode: 'Markdown' });
    } else if (userStates[chatId].state === 'main_menu' && msg.body === "4") {
        userStates[chatId].state = 'strategy_menu';
        const strategiesText =
            '–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å –Ω–∞ –ë–∞–ª–∏\n\n' +
            '1. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∞—Ä–µ–Ω–¥—ã\n' +
            '2. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–∏\n' +
            '3. –ê—Ä–µ–Ω–¥–∞ —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–µ–π\n\n' +
            '‚¨áÔ∏è–ß—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ –æ –∫–∞–∂–¥–æ–π –∏–∑ —ç—Ç–∏—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π, –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –Ω–æ–º–µ—Ä‚¨áÔ∏è';

        await client.sendMessage(chatId, strategiesText);

    } else if (userStates[chatId].state === 'strategy_menu') {
        const messageText = msg.body.trim();
        if (messageText === "1") {
            await client.sendMessage(chatId,
                "*1. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∞—Ä–µ–Ω–¥—ã*\n\n" +
                "*–û–ø–∏—Å–∞–Ω–∏–µ:* –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∞—Ä–µ–Ω–¥—ã –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –ø–æ–∫—É–ø–∫—É –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ —Å —Ü–µ–ª—å—é –µ—ë –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Å–¥–∞—á–∏ –≤ –∞—Ä–µ–Ω–¥—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏—â—É—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π –¥–æ—Ö–æ–¥ –æ—Ç —Å–≤–æ–µ–≥–æ –≤–ª–æ–∂–µ–Ω–∏—è.\n\n" +
                "*–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:*\n    ‚Ä¢ –†–µ–≥—É–ª—è—Ä–Ω—ã–π –ø–æ—Ç–æ–∫ –¥–æ—Ö–æ–¥–æ–≤ –æ—Ç –∞—Ä–µ–Ω–¥—ã.\n    ‚Ä¢ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∏—è –∞—Ä–µ–Ω–¥–Ω–æ–π –ø–ª–∞—Ç—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π.\n    ‚Ä¢ –ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å –æ—Å—Ç–∞–µ—Ç—Å—è –≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏—Ä–æ—Å—Ç–æ–º –µ—ë —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –≤ –±—É–¥—É—â–µ–º.\n\n" +
                "*–†–∏—Å–∫–∏:*\n    ‚Ä¢ –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é (–ø–æ–∏—Å–∫ –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–æ–≤, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ —Ä–µ–º–æ–Ω—Ç).\n    ‚Ä¢ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤ –±–µ–∑ –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–æ–≤.\n    ‚Ä¢ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –∞—Ä–µ–Ω–¥–Ω–æ–π –ø–ª–∞—Ç—ã.\n\n" +
                "*–ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞:*\n    ‚Ä¢ –¶–µ–Ω–∞ –∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–æ–≤: $150,000\n    ‚Ä¢ –î–Ω–µ–≤–Ω–∞—è –∞—Ä–µ–Ω–¥–Ω–∞—è –ø–ª–∞—Ç–∞: $120\n    ‚Ä¢ –°—Ä–µ–¥–Ω—è—è –∑–∞–ø–æ–ª–Ω—è–µ–º–æ—Å—Ç—å: 70% (255 –¥–Ω–µ–π –≤ –≥–æ–¥—É)\n    ‚Ä¢ –ì–æ–¥–æ–≤–æ–π –¥–æ—Ö–æ–¥: 255 –¥–Ω–µ–π * $120 = $30,600\n    ‚Ä¢ –ì–æ–¥–æ–≤—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (10%): $3,060\n    ‚Ä¢ –ß–∏—Å—Ç—ã–π –≥–æ–¥–æ–≤–æ–π –¥–æ—Ö–æ–¥: $27,540\n    ‚Ä¢ –ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: 18.36%\n\n",
                { parse_mode: 'Markdown' }
            );
            await client.sendMessage(chatId,
                "–í—ã –æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å —Å–æ *–°—Ç—Ä–∞—Ç–µ–≥–∏–µ–π –∞—Ä–µ–Ω–¥—ã*.\n\n" +
                "*–û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:*\n" +
                "2. *–°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–∏*\n" +
                "3. *–ê—Ä–µ–Ω–¥–∞ —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–µ–π*\n\n" +
                "–î–ª—è –≤—ã–±–æ—Ä–∞ –¥—Ä—É–≥–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–æ–º–µ—Ä (2 –∏–ª–∏ 3).\n" +
                "–î–ª—è –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –æ—Ç–ø—Ä–∞–≤—å—Ç–µ '—Å—Ç–∞—Ä—Ç'."
            );
        } else if (messageText === "2") {
            await client.sendMessage(chatId,
                "*2. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–∏*\n\n" +
                "*–û–ø–∏—Å–∞–Ω–∏–µ:* –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–∏ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –ø–æ–∫—É–ø–∫—É –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ —Å —Ü–µ–ª—å—é –µ—ë –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø—Ä–æ–¥–∞–∂–∏ –ø–æ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ–π —Ü–µ–Ω–µ. –≠—Ç–æ –ø–æ–¥—Ö–æ–¥ –¥–ª—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏—â—É—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–µ–Ω–∏—è –µ–¥–∏–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏ –æ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏.\n\n" +
                "*–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:*\n    ‚Ä¢ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É–≤–µ–ª–∏—á–µ–Ω–∏—è –∫–∞–ø–∏—Ç–∞–ª–∞ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–µ.\n    ‚Ä¢ –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é –≤ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ.\n\n" +
                "*–†–∏—Å–∫–∏:*\n    ‚Ä¢ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π –∏ –∫–æ–ª–µ–±–∞–Ω–∏–π —Ü–µ–Ω –Ω–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å.\n    ‚Ä¢ –†–∞—Å—Ö–æ–¥—ã –Ω–∞ –ø—Ä–æ–¥–∞–∂—É (–∫–æ–º–∏—Å—Å–∏–∏, –Ω–∞–ª–æ–≥–∏ –∏ –¥—Ä—É–≥–∏–µ —Å–±–æ—Ä—ã).\n    ‚Ä¢ –í–æ–∑–º–æ–∂–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –ø—Ä–æ–¥–∞–∂—É –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏.\n\n" +
                "*–ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞:*\n    ‚Ä¢ –¶–µ–Ω–∞ –∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–æ–≤: $150,000\n    ‚Ä¢ –û–∂–∏–¥–∞–µ–º–∞—è —Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ —á–µ—Ä–µ–∑ –≥–æ–¥: $172,000\n    ‚Ä¢ –†–∞—Å—Ö–æ–¥—ã –Ω–∞ –ø—Ä–æ–¥–∞–∂—É (5%): $8,600\n    ‚Ä¢ –ß–∏—Å—Ç—ã–π –¥–æ—Ö–æ–¥ –æ—Ç –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–∏: $13,400\n    ‚Ä¢ –ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: 8.93%\n\n",
                { parse_mode: 'Markdown' }
            );
            await client.sendMessage(chatId,
                "–í—ã –æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å —Å–æ *–°—Ç—Ä–∞—Ç–µ–≥–∏–µ–π –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–∏*.\n\n" +
                "*–û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:*\n" +
                "1. *–°—Ç—Ä–∞—Ç–µ–≥–∏—è –∞—Ä–µ–Ω–¥—ã*\n" +
                "3. *–ê—Ä–µ–Ω–¥–∞ —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–µ–π*\n\n" +
                "–î–ª—è –≤—ã–±–æ—Ä–∞ –¥—Ä—É–≥–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–æ–º–µ—Ä (1 –∏–ª–∏ 3).\n" +
                "–î–ª—è –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –æ—Ç–ø—Ä–∞–≤—å—Ç–µ '—Å—Ç–∞—Ä—Ç'."
            );
        } else if (messageText === "3") {
            await client.sendMessage(chatId,
                "*3. –ê—Ä–µ–Ω–¥–∞ —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–µ–π*\n\n" +
                "*–û–ø–∏—Å–∞–Ω–∏–µ:* –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Å–¥–∞—á—É –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –≤ –∞—Ä–µ–Ω–¥—É –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø—Ä–æ–¥–∞–∂–µ–π. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–Ω–≤–µ—Å—Ç–æ—Ä—É –ø–æ–ª—É—á–∞—Ç—å —Ç–µ–∫—É—â–∏–π –¥–æ—Ö–æ–¥ –æ—Ç –∞—Ä–µ–Ω–¥—ã, –∞ –∑–∞—Ç–µ–º –∏–∑–≤–ª–µ—á—å –ø—Ä–∏–±—ã–ª—å –æ—Ç –ø—Ä–∏—Ä–æ—Å—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏.\n\n" +
                "*–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:*\n    ‚Ä¢ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–µ–Ω–∏—è –¥–≤–æ–π–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞: —Ç–µ–∫—É—â–µ–≥–æ –æ—Ç –∞—Ä–µ–Ω–¥—ã –∏ –∫–∞–ø–∏—Ç–∞–ª—å–Ω–æ–≥–æ –æ—Ç –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–∏.\n    ‚Ä¢ –ë–æ–ª–µ–µ –≤—ã—Å–æ–∫–∞—è —Å–æ–≤–æ–∫—É–ø–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å.\n\n" +
                "*–†–∏—Å–∫–∏:*\n    ‚Ä¢ –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é –Ω–∞ —ç—Ç–∞–ø–µ –∞—Ä–µ–Ω–¥—ã.\n    ‚Ä¢ –í–æ–∑–º–æ–∂–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø–æ–≤–ª–∏—è—Ç—å –∫–∞–∫ –Ω–∞ –∞—Ä–µ–Ω–¥–Ω—É—é –ø–ª–∞—Ç—É, —Ç–∞–∫ –∏ –Ω–∞ —Ü–µ–Ω—É –ø—Ä–æ–¥–∞–∂–∏.\n    ‚Ä¢ –†–∞—Å—Ö–æ–¥—ã –Ω–∞ –ø—Ä–æ–¥–∞–∂—É (–∫–æ–º–∏—Å—Å–∏–∏, –Ω–∞–ª–æ–≥–∏ –∏ –¥—Ä—É–≥–∏–µ —Å–±–æ—Ä—ã).\n\n" +
                "*–ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞:*\n    ‚Ä¢ –¶–µ–Ω–∞ –∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–æ–≤: $150,000\n    ‚Ä¢ –î–Ω–µ–≤–Ω–∞—è –∞—Ä–µ–Ω–¥–Ω–∞—è –ø–ª–∞—Ç–∞: $120\n    ‚Ä¢ –°—Ä–µ–¥–Ω—è—è –∑–∞–ø–æ–ª–Ω—è–µ–º–æ—Å—Ç—å: 70% (255 –¥–Ω–µ–π –≤ –≥–æ–¥—É)\n    ‚Ä¢ –ì–æ–¥–æ–≤–æ–π –¥–æ—Ö–æ–¥ –æ—Ç –∞—Ä–µ–Ω–¥—ã: $27,540\n    ‚Ä¢ –û–∂–∏–¥–∞–µ–º–∞—è —Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ —á–µ—Ä–µ–∑ –≥–æ–¥: $172,000\n    ‚Ä¢ –†–∞—Å—Ö–æ–¥—ã –Ω–∞ –ø—Ä–æ–¥–∞–∂—É (5%): $8,600\n    ‚Ä¢ –ß–∏—Å—Ç—ã–π –¥–æ—Ö–æ–¥ –æ—Ç –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–∏: $13,400\n    ‚Ä¢ –°–æ–≤–æ–∫—É–ø–Ω—ã–π –≥–æ–¥–æ–≤–æ–π –¥–æ—Ö–æ–¥: $40,940\n    ‚Ä¢ –°–æ–≤–æ–∫—É–ø–Ω–∞—è –≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: 27.29%\n\n",
                { parse_mode: 'Markdown' }
            );
            await client.sendMessage(chatId,
                "–í—ã –æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å —Å–æ *–ê—Ä–µ–Ω–¥–∞ —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–µ–π*.\n\n" +
                "*–û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:*\n" +
                "1. *–°—Ç—Ä–∞—Ç–µ–≥–∏—è –∞—Ä–µ–Ω–¥—ã*\n" +
                "2. *–°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–∏*\n\n" +
                "–î–ª—è –≤—ã–±–æ—Ä–∞ –¥—Ä—É–≥–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–æ–º–µ—Ä (1 –∏–ª–∏ 2).\n" +
                "–î–ª—è –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –æ—Ç–ø—Ä–∞–≤—å—Ç–µ '—Å—Ç–∞—Ä—Ç'."
            );
        } else {
            await client.sendMessage(chatId, '–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–æ–º–µ—Ä –æ—Ç 1 –¥–æ 3 –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.');
        }
    } else if (userStates[chatId].state === 'questionaire') {
        if (userStates[chatId].question === "1") {
            if (msg.body.trim() === "1") {
                questionnaireAnswer[chatId] = { answer1: options[0][1] };
            } else if (msg.body.trim() === "2") {
                questionnaireAnswer[chatId] = { answer1: options[0][2] };
            } else if (msg.body.trim() === "3") {
                questionnaireAnswer[chatId] = { answer1: options[0][3] };
            } else {
                questionnaireAnswer[chatId] = { answer1: msg.body };
            }
            userStates[chatId].question = "2";
            await sendQuestion(chatId, questions[1], options[1]);
        } else if (userStates[chatId].question === "2") {
            if (msg.body.trim() === "1") {
                questionnaireAnswer[chatId].answer2 = options[1][0];
            } else if (msg.body.trim() === "2") {
                questionnaireAnswer[chatId].answer2 = options[1][1];
            } else if (msg.body.trim() === "3") {
                questionnaireAnswer[chatId].answer2 = options[1][2];
            } else if (msg.body.trim() === "4") {
                questionnaireAnswer[chatId].answer2 = options[1][3];
            } else {
                questionnaireAnswer[chatId].answer2 = msg.body;
            }
            userStates[chatId].question = "3";
            await sendQuestion(chatId, questions[2], options[2]);
        } else if (userStates[chatId].question === "3") {
            if (msg.body.trim() === "1") {
                questionnaireAnswer[chatId].answer3 = options[2][0];
            } else if (msg.body.trim() === "2") {
                questionnaireAnswer[chatId].answer3 = options[2][1];
            } else if (msg.body.trim() === "3") {
                questionnaireAnswer[chatId].answer3 = options[2][2];
            } else if (msg.body.trim() === "4") {
                questionnaireAnswer[chatId].answer3 = options[2][3];
            } else if (msg.body.trim() === "5") {
                questionnaireAnswer[chatId].answer3 = options[2][4];
            } else {
                questionnaireAnswer[chatId].answer3 = msg.body;
            }
            userStates[chatId].question = "4";
            await sendQuestion(chatId, questions[3], options[3]);
        } else if (userStates[chatId].question === "4") {
            if (msg.body.trim() === "1") {
                questionnaireAnswer[chatId].answer4 = options[3][0];
            } else if (msg.body.trim() === "2") {
                questionnaireAnswer[chatId].answer4 = options[3][1];
            } else if (msg.body.trim() === "3") {
                questionnaireAnswer[chatId].answer4 = options[3][2];
            } else if (msg.body.trim() === "4") {
                questionnaireAnswer[chatId].answer4 = options[3][3];
            } else if (msg.body.trim() === "5") {
                questionnaireAnswer[chatId].answer4 = options[3][4];
            } else {
                questionnaireAnswer[chatId].answer4 = msg.body;
            }
            userStates[chatId].question = "5";
            await sendQuestion(chatId, questions[4], options[4]);
        } else if (userStates[chatId].question === "5") {
            if (msg.body.trim() === "1") {
                questionnaireAnswer[chatId].answer5 = options[4][0];
            } else if (msg.body.trim() === "2") {
                questionnaireAnswer[chatId].answer5 = options[4][1];
            } else if (msg.body.trim() === "3") {
                questionnaireAnswer[chatId].answer5 = options[4][2];
            } else if (msg.body.trim() === "4") {
                questionnaireAnswer[chatId].answer5 = options[4][3];
            } else if (msg.body.trim() === "5") {
                questionnaireAnswer[chatId].answer5 = options[4][4];
            } else {
                questionnaireAnswer[chatId].answer5 = msg.body;
            }
            userStates[chatId].question = "6";
            await sendQuestion(chatId, questions[5], options[5]);
        } else if (userStates[chatId].question === "6") {
            if (msg.body.trim() === "1") {
                questionnaireAnswer[chatId].answer6 = options[5][0];
            } else if (msg.body.trim() === "2") {
                questionnaireAnswer[chatId].answer6 = options[5][1];
            } else if (msg.body.trim() === "3") {
                questionnaireAnswer[chatId].answer6 = options[5][2];
            } else if (msg.body.trim() === "4") {
                questionnaireAnswer[chatId].answer6 = options[5][3];
            } else {
                questionnaireAnswer[chatId].answer6 = msg.body;
            }
            userStates[chatId].question = "7";
            await sendQuestion(chatId, questions[6], options[6]);
        } else if (userStates[chatId].question === "7") {
            if (msg.body.trim() === "2") {
                questionnaireAnswer[chatId].answer7 = options[6][1];
            } else {
                questionnaireAnswer[chatId].answer7 = msg.body;
            }
            userStates[chatId].question = "8";
            await sendQuestion(chatId, questions[7], options[7]);
        } else if (userStates[chatId].question === "8") {
            if (msg.body.trim() === "1") {
                questionnaireAnswer[chatId].answer8 = options[7][0];
            } else if (msg.body.trim() === "2") {
                questionnaireAnswer[chatId].answer8 = options[7][1];
            } else if (msg.body.trim() === "3") {
                questionnaireAnswer[chatId].answer8 = options[7][2];
            } else {
                questionnaireAnswer[chatId].answer8 = msg.body;
            }
            userStates[chatId].question = "9";
            await sendQuestion(chatId, questions[8], options[8]);
        } else if (userStates[chatId].question === "9") {
            if (msg.body.trim() === "1") {
                questionnaireAnswer[chatId].answer9 = options[8][0];
            } else if (msg.body.trim() === "2") {
                questionnaireAnswer[chatId].answer9 = options[8][1];
            } else {
                questionnaireAnswer[chatId].answer9 = msg.body;
            }
            userStates[chatId].question = "10";
            await sendQuestion(chatId, questions[9], []);
        } else if (userStates[chatId].question === "10") {
            questionnaireAnswer[chatId].answer10 = msg.body;
            userStates[chatId].question = "11";
            await sendQuestion(chatId, questions[10], []);
        } else if (userStates[chatId].question === "11") {
            questionnaireAnswer[chatId].answer11 = msg.body;
            const message = `üìù * –ê–Ω–∫–µ—Ç–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ *\n\n` +
                `1. * –¶–µ–ª—å –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ *: ${questionnaireAnswer[chatId].answer1} \n` +
                `2. * –¢–∏–ø –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ *: ${questionnaireAnswer[chatId].answer2} \n` +
                `3. * –ë—é–¥–∂–µ—Ç *: ${questionnaireAnswer[chatId].answer3} \n` +
                `4. * –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º—ã–π —Ä–∞–π–æ–Ω *: ${questionnaireAnswer[chatId].answer4} \n` +
                `5. * –û–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å *: ${questionnaireAnswer[chatId].answer5} \n` +
                `6. * –í—Ä–µ–º—è –ø–æ–∫—É–ø–∫–∏ *: ${questionnaireAnswer[chatId].answer6} \n` +
                `7. * –û—Å–æ–±—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è *: ${questionnaireAnswer[chatId].answer7} \n` +
                `8. * –°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã *: ${questionnaireAnswer[chatId].answer8} \n` +
                `9. * –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ –≤ –æ–ø–ª–∞—Ç–µ *: ${questionnaireAnswer[chatId].answer9} \n` +
                `10. * –ü–æ–ª–Ω–æ–µ –∏–º—è *: ${questionnaireAnswer[chatId].answer10} \n` +
                `11. * –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ *: ${questionnaireAnswer[chatId].answer11} `;

            await client.sendMessage(process.env.MANAGER_GROUP, message);

            userStates[chatId].state = 'strategy_menu';
            await client.sendMessage(chatId, "–°–ø–∞—Å–∏–±–æ –∑–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–Ω–∫–µ—Ç—ã. –ú—ã —Å–∫–æ—Ä–æ —Å –≤–∞–º–∏ —Å–≤—è–∂–µ–º—Å—è.\n\n –ß—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–æ—Ö–æ–¥–∞ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Ü–∏—Ñ—Ä—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –ø—É–Ω–∫—Ç–∞ –º–µ–Ω—é:\n\n" +
                "1. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∞—Ä–µ–Ω–¥—ã\n" +
                "2. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–∏\n" +
                "3. –ê—Ä–µ–Ω–¥–∞ —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–µ–π\n\n" +
                "–ï—Å–ª–∏ –∂–µ –í—ã —Ö–æ—Ç–∏—Ç–µ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–º—É –º–µ–Ω—é, —Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ '—Å—Ç–∞—Ä—Ç' –≤ —á–∞—Ç");
            delete questionnaireAnswer[chatId];
        }
    } else if (userStates[chatId].state === 'expert_help') {
        if (userStates[chatId].question === 'email') {
            expertHelpAnswer[chatId] = { email: msg.body };
            await client.sendMessage(chatId,
                '*–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –≤–∞—à –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞:*',
                { parse_mode: 'Markdown' }
            );
            userStates[chatId].question = 'phone';
        } else if (userStates[chatId].question === 'phone') {
            expertHelpAnswer[chatId].phone = msg.body;
            await client.sendMessage(chatId,
                '*–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –≤–∞—à–µ –§–ò–û:*',
                { parse_mode: 'Markdown' }
            );
            userStates[chatId].question = 'fio';
        } else if (userStates[chatId].question === 'fio') {
            expertHelpAnswer[chatId].fio = msg.body;
            await client.sendMessage(process.env.MANAGER_GROUP,
                'üí° *–¢–µ–º–∞:* –≠–∫—Å–ø–µ—Ä—Ç–Ω–∞—è –ø–æ–º–æ—â—å —Å –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é\n' +
                'üìß *–ê–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã:* ' + expertHelpAnswer[msg.from].email + '\n' +
                'üì± *–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞:* ' + expertHelpAnswer[msg.from].phone + '\n' +
                'üë®üèª‚Äçüíª *–§–ò–û:* ' + expertHelpAnswer[msg.from].fio,
                { parse_mode: 'Markdown' }
            );
            userStates[chatId].state = 'strategy_menu';
            await client.sendMessage(chatId, "–ù–∞—à–∏ –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç—ã —Å–≤—è–∂—É—Ç—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è, —á—Ç–æ–±—ã –æ–±—Å—É–¥–∏—Ç—å –≤–∞—à–∏ —Ü–µ–ª–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π.\n\n –ß—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–æ—Ö–æ–¥–∞ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Ü–∏—Ñ—Ä—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –ø—É–Ω–∫—Ç–∞ –º–µ–Ω—é:\n\n" +
                "1. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∞—Ä–µ–Ω–¥—ã\n" +
                "2. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–∏\n" +
                "3. –ê—Ä–µ–Ω–¥–∞ —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–µ–π\n\n" +
                "–ï—Å–ª–∏ –∂–µ –í—ã —Ö–æ—Ç–∏—Ç–µ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–º—É –º–µ–Ω—é, —Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ '—Å—Ç–∞—Ä—Ç' –≤ —á–∞—Ç");
        }
    }
});

async function sendQuestion(chatId, text, optionss) {
    const optionssText = optionss.map((options, index) => `${index + 1}. ${options} `).join('\n');
    await client.sendMessage(chatId, `${text} \n\n${optionssText} `);
}

// Start the client
// (async () => {
//     browser = await puppeteer.launch({
//         executablePath: process.env.PUPPETEER_EXECUTABLE_PATH,
//         args: [
//             '--no-sandbox', '--disable-setuid-sandbox'
//         ],
//         headless: true,
//     });
//     client.initialize();
// })();

client.initialize();

client.on('qr', async (qr) => {
        console.log('QR RECEIVED');
        qrcode_terminal.generate(qr, { small: true });
});

client.on('authenticated', () => {
    console.log('AUTHENTICATED');
});

client.on('auth_failure', msg => {
    // Fired if session restore was unsuccessful
    console.error('AUTHENTICATION FAILURE', msg);
});

client.on('disconnected', (reason) => {
    console.log('Client was logged out', reason);
})